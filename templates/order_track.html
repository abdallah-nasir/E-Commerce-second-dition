{% extends 'base.html' %}


{% block content %}
<style type="text/css">
#custom-id{
    margin-top:20px !important;
}
</style>
        <!--====== App Content ======-->
        <div class="app-content">

            <!--====== Section 1 ======-->
            <div class="u-s-p-y-60">

                <!--====== Section Content ======-->
                <div class="section__content">
                    <div class="container">
                        <div class="breadcrumb">
                            <div class="breadcrumb__wrap">
                                <ul class="breadcrumb__list">
                                    <li class="has-separator">

                                        <a href="{% url 'home:home' %}">Home</a></li>
                                    <li class="is-marked">

                                        <a href="{% url 'home:order_track' slug=profile.user %}">Track Order</a></li>
                                    </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--====== End - Section 1 ======-->


            <!--====== Section 2 ======-->
            <div class="u-s-p-b-60">

                <!--====== Section Content ======-->
                <div class="section__content">
                    <div class="dash">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-3 col-md-12">

                                    <!--====== Dashboard Features ======-->
                                    <div class="dash__box dash__box--bg-white dash__box--shadow u-s-m-b-30">
                                        <div class="dash__pad-1">

                                            <span class="dash__text u-s-m-b-16">Hello, {{request.user.first_name|title}} {{request.user.last_name|title}}</span>
                                            <ul class="dash__f-list">
                                                <li>

                                                    <a  href="{% url 'home:profile' slug=profile.user %}">Manage My Account</a></li>
                                                <li>

                                                    <a href="{% url 'home:profile_account' slug=profile.user %}">My Profile</a></li>
                                                <li>

                                                    <a href="{% url 'home:address' slug=profile.user %}">Address Book</a></li>
                                                <li>

                                                    <a class="dash-active" href="{% url 'home:order_track' slug=profile.user %}">Track Order</a></li>
                                                <!-- <li>

                                                    <a href="{%url 'home:order_track' slug=profile.user %}">My Orders</a></li> -->
                                                 <!-- <li>

                                                    <a href="dash-payment-option.html">My Payment Options</a></li> -->
                                                <li> 

                                                    <a href="{% url 'home:canceled_order' slug=profile.user %}">My Returns & Cancellations</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="dash__box dash__box--bg-white dash__box--shadow dash__box--w">
                                        <div class="dash__pad-1">
                                            <ul class="dash__w-list">
                                                <li>
                                                    <div class="dash__w-wrap">

                                                        <span class="dash__w-icon dash__w-icon-style-1"><i class="fas fa-cart-arrow-down"></i></span>

                                                        <span class="dash__w-text">{{order}}</span>

                                                        <span class="dash__w-name">Orders Placed</span></div>
                                                </li>
                                                <li>
                                                    <div class="dash__w-wrap">

                                                        <span class="dash__w-icon dash__w-icon-style-2"><i class="fas fa-times"></i></span>

                                                        <span class="dash__w-text">{{canceled}}</span>

                                                        <span class="dash__w-name">Cancel Orders</span></div>
                                                </li>
                                                <!-- <li>
                                                    <div class="dash__w-wrap">

                                                        <span class="dash__w-icon dash__w-icon-style-3"><i class="far fa-heart"></i></span>

                                                        <span class="dash__w-text">0</span>

                                                        <span class="dash__w-name">Wishlist</span></div>
                                                </li> -->
                                            </ul>
                                        </div>
                                    </div>
                                    <!--====== End - Dashboard Features ======-->
                                </div>

                                <div class="col-lg-9 col-md-12">
                                    <div class="dash__box dash__box--shadow dash__box--radius dash__box--bg-white ">
                                        <div class="dash__pad-2">
                                            <h1 class="dash__h1 u-s-m-b-14">Track your Order</h1>

                                            <span class="dash__text u-s-m-b-30">To track your order please enter your Order ID in the box below and press the "Track" button. This was given to you on your receipt and in the confirmation email you should have received.</span>
                                            <form class="dash-track-order" method="POST">
                                                {% csrf_token %}
                                                <div class="gl-inline">
                                                    <div class="u-s-m-b-30">

                                                        <label class="gl-label" for="order-id">Order ID *</label>

                                                        <input class="input-text input-text--primary-style" type="text" name="track" id="order-id" placeholder="Found in your confirmation email" required></div>
                                                    <!-- <div class="u-s-m-b-30">

                                                        <label class="gl-label" for="track-email">Email *</label>

                                                        <input class="input-text input-text--primary-style" type="text" id="track-email" placeholder="Email you used during checkout" required></div> -->
                                                </div>

                                                <button  class="btn btn--e-brand-b-2" type="submit">TRACK</button>
                                            </form>
<div id="my-div"></div>

                                        </div>
                                    </div>
                                        {% if orders %}
                                    <div id="custom-id" class="dash__box dash__box--shadow dash__box--radius dash__box--bg-white u-s-m-b-30">
                                        <div class="dash__pad-2 ">
                                            <h1 class="dash__h1 u-s-m-b-14">My Orders</h1>

                                            <span class="dash__text u-s-m-b-30">Here you can see all products that have been delivered.</span>
                                            <form class="m-order u-s-m-b-30">
                                                <div class="m-order__select-wrapper">

                                                    <label class="u-s-m-r-8" for="my-order-sort">Show:</label><select class="select-box select-box--primary-style" id="my-order-sort">
                                                        <option selected>Last 5 orders</option>
                                                        <option>Last 15 days</option>
                                                        <option>Last 30 days</option>
                                                        <option>Last 6 months</option>
                                                        <option>Orders placed in 2018</option>
                                                        <option>All Orders</option>
                                                    </select></div>
                                            </form>
                                            <div class="m-order__list">
                                                {% for i in orders %}
                                                <div class="m-order__get">
                                                    <div class="manage-o__header u-s-m-b-30">
                                                        <div class="dash-l-r">
                                                            <div>
                                                                <div class="manage-o__text-2 u-c-secondary">Order #{{i.track_number}}</div>
                                                                <div class="manage-o__text u-c-silver">Placed on {{i.order_date}}</div>
                                                            </div>
                                                            <div>
                                                                <div class="dash__link dash__link--brand">

                                                                    <a href="{% url 'home:manage_order' slug=i.user %}">MANAGE</a></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% for b in i.cart.products.all %}
                                                    <div class="manage-o__description">
                                                        <div class="description__container">

                                                            <div class="description__img-wrap">

                                                                <img class="u-img-fluid" src="{{b.products.image.first.image.url}}" alt=""></div>
                                                            <div class="description-title">{{b.products.name|title}}</div>
                                                        </div>
                                                        <div class="description__info-wrap">
                                                            <div>

                                                                <span class="manage-o__badge badge--{{i.statue}}">{{i.statue}}</span></div>
                                                            <div>

                                                                <span class="manage-o__text-2 u-c-silver">Quantity:

                                                                    <span class="manage-o__text-2 u-c-secondary">{{b.quantity}}</span></span></div>
                                                            <div>

                                                                <span class="manage-o__text-2 u-c-silver">Total:

                                                                    <span class="manage-o__text-2 u-c-secondary">${{b.discount}}</span></span></div>
                                                        </div>
                                                    </div>
                                                    {% endfor %}
                                                </div>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div>
                                  
                                    
                                    {% endif %}
                                </div>
                                
                            </div>
                        
                                
                           
                        </div>
                    </div>
                </div>
                <!--====== End - Section Content ======-->
            </div>
            <!--====== End - Section 2 ======-->
        </div>
        <!--====== End - App Content ======-->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<script type="text/javascript">
$("#ajaxbutton").click(function () {
    const productId = $(this).val();  // get the selected subject ID from the HTML dropdown list 
    $.ajax({                       // initialize an AJAX request
        type: "POST",
        url: '{% url "home:order_track" slug=profile.user %}',
        data: {
            'product': productId,       // add the country id to the POST parameters
            'csrfmiddlewaretoken':$('input[name=csrfmiddlewaretoken]').val(),
        },
        success: function (data) {   // `data` is from `get_topics_ajax` view function
            
            let html_data2=`
                                    `
            ;
            data.forEach(function (data) {
                html_data2 += `
                ${data.track_number}
            
            
                `
            });
            $("#my-div").html(html_data2);
            
        }
    });
    });
</script>
{% endblock %}